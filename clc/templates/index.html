{% extends "base.html" %}
{% load i18n %}
{% block content %}
 <br />
 <div class="main_container">
  <div class="content_wrapper">
   <div class="content_column">
    <div class="innertube">
     <h1>{% trans "Welcome to your own bucket list maker." %}</h1><br/>
     <h2>{% trans "Create a bucket list and share it with your friends... or not!" %}</h2><br/>
     <h3>{% trans "Some examples of challenges:" %}</h3>
     <br />
     {% for ci in challenge_instances %}
      {% if forloop.first %}
       <div class="row table_head">
        <span class="cell description">{% trans "Description" %}</span>
        <span class="cell category">{% trans "Category" %}</span>
       </div>
	  {% endif %}
      {% with ci.challenge as c %}
       <div class="row" id="challenge-row-{{ ci.id }}" style="background-color:rgb({{c.category.red}},{{c.category.green}},{{c.category.blue}});">
        <span class="cell description"><a href="/{{ ci.challenge_list.name }}">{{ c.description }}</a></span>
        <span class="cell category">{{ c.category.name }}</span>
	   </div>
      {% endwith %}
     {% endfor %}
     <br />
    </div>
   </div>
  </div>
  <div class="left_column">
   <div class="innertube">
    <form action="" method="post">{% csrf_token %}
     <div class="horizontal_form">
      <div class="header">{% trans "Create an account" %}</div>
      {% for field in signup_form.visible_fields %}
       <div class="item">
        <div class="label">{{ field.label_tag }}</div>
 	    <div class="data">{{ field }}</div>
 	    {% if field.errors %}
         <div class="ui-widget" style="float:left;padding: .3em">
	      <div class="ui-state-highlight ui-corner-all" style="padding: 0 .7em;"> 
	       <p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span>{{ field.errors|join:", " }}</p>
	      </div>
	     </div>
	    {% endif %}
	    <div class="description">{{ field.help_text }}</div>
	   </div>
      {% endfor %}
      {% for hidden in signup_form.hidden_fields %}
       {{ hidden }}
      {% endfor %}
      <br />
      <input type="submit" value="{% trans "Sign me up" %}" style="left:160px;" />
	 </div>
	</form>
    <br />
    <br />
    <form action="" method="post">{% csrf_token %}
     <div class="horizontal_form">
      <div class="header">{% trans "Log in" %}</div>
      {% for field in login_form.visible_fields %}
       <div class="item">
        <div class="label">{{ field.label_tag }}</div>
        <div class="data">{{ field }}</div>
        {% if field.errors %}
         <div class="ui-widget" style="float:left;padding: .3em">
          <div class="ui-state-highlight ui-corner-all" style="padding: 0 .7em;"> 
           <p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span>{{ field.errors|join:", " }}</p>
          </div>
         </div>
        {% endif %}
        <div class="description">{{ field.help_text }}</div>
       </div>
      {% endfor %}
     </div>
     {% for hidden in login_form.hidden_fields %}
      {{ hidden }}
     {% endfor %}
     <center><a href="" id="send-password">{% trans "Forgot your password?" %}</a></center>
     <br />
     <input type="submit" value="{% trans "Log me in"%}" style="left:160px;" />
    </form>
    <div id="send-password-form" title="{% trans "Reset your password"%}">
      <p class="validateTips">{% trans "Please enter your email address so we can send you instructions to reset your password." %}</p>
      <form>
      <fieldset>
       <label for="ideabox-email">{% trans "Email" %}</label>
       <input type="text" name="email" id="send-password-email" value="" class="text ui-widget-content ui-corner-all" />
      </fieldset>
     </form>
    </div>
   </div>
  </div>
 </div>
 <br />
 <br />
 <script type="text/javascript">
	$(function(){ 
		$( "input:submit" ).button();
		$(".logme-button").button({
			icons: {
				primary: "ui-icon-lightbulb"
			}
		}).click(function(){
			window.location = "/?next="+window.location;
		});
		$( "#send-password-form" ).dialog({
			autoOpen: false,
			height: 240,
			width: 350,
			modal: true,
			buttons: [
				{
					text: "{% trans "Send me an email" %}",
					click: function() {
						$( this ).dialog( "close" );
						$.post(
							"/send_password", 
							{"email": $("#send-password-email").val(),} 
						);
					}
				},
				{
					text: "{% trans "Cancel" %}",
					click: function() {
						$( this ).dialog( "close" );
					}
				}
			]
		});
		$("#send-password").click(function(){
			$( "#send-password-form" ).dialog( "open" );
			return false;
		});
	});
 </script>
{% endblock content %}
